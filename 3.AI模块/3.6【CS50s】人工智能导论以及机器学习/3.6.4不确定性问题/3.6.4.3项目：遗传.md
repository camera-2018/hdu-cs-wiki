# é¡¹ç›®ï¼šé—ä¼ 

::: tip
æˆ‘ä»¬ä¸ºä½ æä¾›äº†ä¸€ä¸ªç®€å•æœ‰è¶£çš„é¡¹ç›®ï¼Œå¸®åŠ©ä½ è¿›è¡ŒçŸ¥è¯†å·©å›ºï¼Œè¯·è®¤çœŸé˜…è¯»æ–‡æ¡£å†…å®¹ã€‚

å¦‚æœä½ å¡ä½äº†ï¼Œè¯·è®°å¾—å›æ¥é˜…è¯»æ–‡æ¡£ï¼Œæˆ–è¯·æ±‚èº«è¾¹äººçš„å¸®åŠ©ã€‚
:::

::: tip ğŸ“¥
æœ¬èŠ‚é™„ä»¶ä¸‹è½½ <Download url="https://cdn.xyxsw.site/code/3-Projects.zip"/>
:::

## èƒŒæ™¯

GJB2 åŸºå› çš„çªå˜ç‰ˆæœ¬æ˜¯å¯¼è‡´æ–°ç”Ÿå„¿å¬åŠ›éšœç¢çš„ä¸»è¦åŸå› ä¹‹ä¸€ã€‚æ¯ä¸ªäººéƒ½æºå¸¦ä¸¤ä¸ªç‰ˆæœ¬çš„åŸºå› ï¼Œå› æ­¤æ¯ä¸ªäººéƒ½æœ‰å¯èƒ½æ‹¥æœ‰ 0ã€1 æˆ– 2 ä¸ªå¬åŠ›éšœç¢ç‰ˆæœ¬çš„ GJB2 åŸºå› ã€‚ä¸è¿‡ï¼Œé™¤éä¸€ä¸ªäººæ¥å—åŸºå› æµ‹è¯•ï¼Œå¦åˆ™è¦çŸ¥é“ä¸€ä¸ªäººæ‹¥æœ‰å¤šå°‘ä¸ªå˜å¼‚çš„ GJB2 åŸºå› å¹¶ä¸é‚£ä¹ˆå®¹æ˜“ã€‚å­˜åœ¨ä¸€äº› "ç‰¹æ®ŠçŠ¶æ€"ï¼šæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°ä¸€ä¸ªäººæ˜¯å¦å¬åŠ›æŸä¼¤ï¼Œä½†è¿™ä¸ä¸€å®šèƒ½ç›´æ¥åˆ¤æ–­æ˜¯å¦æœ‰çªå˜åŸºå› ã€‚æ¯•ç«Ÿï¼Œæœ‰äº›äººå¯èƒ½æœ‰ 1 æˆ– 2 ä¸ªçªå˜çš„ GJB2 åŸºå› ï¼Œä½†æ²¡æœ‰è¡¨ç°å‡ºå¬åŠ›éšœç¢ï¼Œè€Œå…¶ä»–äººå¯èƒ½æ²¡æœ‰çªå˜çš„ GJB2 åŸºå› ï¼Œä½†ä»ç„¶è¡¨ç°å‡ºå¬åŠ›éšœç¢ã€‚

æ¯ä¸ªå­©å­éƒ½ä¼šä»ä»–ä»¬çš„çˆ¶æ¯é‚£é‡Œç»§æ‰¿ä¸€ä¸ª GJB2 åŸºå› ã€‚å¦‚æœçˆ¶æ¯æœ‰ä¸¤ä¸ªå˜å¼‚åŸºå› ï¼Œé‚£ä¹ˆä»–ä»¬ä¼šå°†å˜å¼‚åŸºå› ä¼ ç»™å­©å­ï¼›å¦‚æœçˆ¶æ¯æ²¡æœ‰å˜å¼‚åŸºå› ï¼Œé‚£ä¹ˆä»–ä»¬ä¸ä¼šå°†å˜å¼‚åŸºå› ä¼ ç»™å­©å­ï¼›å¦‚æœçˆ¶æ¯æœ‰ä¸€ä¸ªå˜å¼‚åŸºå› ï¼Œé‚£ä¹ˆè¯¥åŸºå› ä¼ ç»™å­©å­çš„æ¦‚ç‡ä¸º 0.5ã€‚ä¸è¿‡ï¼Œåœ¨åŸºå› è¢«ä¼ é€’åï¼Œå®ƒæœ‰ä¸€å®šçš„æ¦‚ç‡å‘ç”Ÿé¢å¤–çš„çªå˜ï¼šä»å¯¼è‡´å¬åŠ›éšœç¢çš„åŸºå› ç‰ˆæœ¬è½¬å˜ä¸ºä¸å¯¼è‡´å¬åŠ›éšœç¢çš„ç‰ˆæœ¬ï¼Œæˆ–è€…åè¿‡æ¥ã€‚

æˆ‘ä»¬å¯ä»¥å°è¯•é€šè¿‡å¯¹æ‰€æœ‰ç›¸å…³å˜é‡å½¢æˆä¸€ä¸ªè´å¶æ–¯ç½‘ç»œæ¥æ¨¡æ‹Ÿæ‰€æœ‰è¿™äº›å…³ç³»ï¼Œå°±åƒä¸‹é¢è¿™ä¸ªç½‘ç»œä¸€æ ·ï¼Œå®ƒè€ƒè™‘äº†ä¸€ä¸ªç”±ä¸¤ä¸ªçˆ¶æ¯å’Œä¸€ä¸ªå­©å­ç»„æˆçš„å®¶åº­ã€‚

![](https://cdn.xyxsw.site/FNyab3RWQo3EA8xu8T7cyLwhnyh.png)

å®¶åº­ä¸­çš„æ¯ä¸ªäººéƒ½æœ‰ä¸€ä¸ª `Gene` éšæœºå˜é‡ï¼Œä»£è¡¨ä¸€ä¸ªäººæœ‰å¤šå°‘ä¸ªç‰¹å®šåŸºå› ï¼š 0ã€1 æˆ– 2 ã€‚å®¶æ—ä¸­çš„æ¯ä¸ªäººä¹Ÿæœ‰ä¸€ä¸ª `Trait` éšæœºå˜é‡ï¼Œå®ƒæ˜¯ `yes` æˆ– `no`ï¼Œå–å†³äºè¯¥äººæ˜¯å¦è¡¨è¾¾åŸºäºè¯¥åŸºå› çš„æ€§çŠ¶ï¼ˆä¾‹å¦‚ï¼Œå¬åŠ›éšœç¢ï¼‰ã€‚ä»æ¯ä¸ªäººçš„ `Gene` å˜é‡åˆ°ä»–ä»¬çš„ `Trait` å˜é‡ä¹‹é—´æœ‰ä¸€ä¸ªç®­å¤´ï¼Œä»¥è¡¨ç¤ºä¸€ä¸ªäººçš„åŸºå› å½±å“ä»–ä»¬å…·æœ‰ç‰¹å®šæ€§çŠ¶çš„æ¦‚ç‡ã€‚åŒæ—¶ï¼Œä¹Ÿæœ‰ä¸€ä¸ªç®­å¤´ä»æ¯äº²å’Œçˆ¶äº²çš„ `Gene` éšæœºå˜é‡åˆ°ä»–ä»¬å­©å­çš„ `Gene` éšæœºå˜é‡ï¼šå­©å­çš„åŸºå› å–å†³äºä»–ä»¬çˆ¶æ¯çš„åŸºå› ã€‚

ä½ åœ¨è¿™ä¸ªé¡¹ç›®ä¸­çš„ä»»åŠ¡æ˜¯ä½¿ç”¨è¿™ä¸ªæ¨¡å‹å¯¹äººç¾¤è¿›è¡Œæ¨æ–­ã€‚ç»™å‡ºäººä»¬çš„ä¿¡æ¯ï¼Œä»–ä»¬çš„çˆ¶æ¯æ˜¯è°ï¼Œä»¥åŠä»–ä»¬æ˜¯å¦å…·æœ‰ç”±ç‰¹å®šåŸºå› å¼•èµ·çš„ç‰¹å®šå¯è§‚å¯Ÿç‰¹å¾ï¼ˆå¦‚å¬åŠ›æŸå¤±ï¼‰ï¼Œä½ çš„äººå·¥æ™ºèƒ½å°†æ¨æ–­å‡ºæ¯ä¸ªäººçš„åŸºå› çš„æ¦‚ç‡åˆ†å¸ƒï¼Œä»¥åŠä»»ä½•ä¸€ä¸ªäººæ˜¯å¦ä¼šè¡¨ç°å‡ºæœ‰å…³ç‰¹å¾çš„æ¦‚ç‡åˆ†å¸ƒã€‚

## ç†è§£

æ‰“å¼€ `data/family0.csv`ï¼Œçœ‹çœ‹æ•°æ®ç›®å½•ä¸­çš„ä¸€ä¸ªæ ·æœ¬æ•°æ®é›†ï¼ˆä½ å¯ä»¥åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­æ‰“å¼€ï¼Œæˆ–è€…åœ¨ Google Sheetsã€Excel æˆ– Apple Numbers ç­‰ç”µå­è¡¨æ ¼åº”ç”¨ç¨‹åºä¸­æ‰“å¼€ï¼‰ã€‚æ³¨æ„ï¼Œç¬¬ä¸€è¡Œå®šä¹‰äº†è¿™ä¸ª CSV æ–‡ä»¶çš„åˆ—ï¼š`name`, `mother`, `father`, å’Œ `trait`ã€‚ä¸‹ä¸€è¡Œè¡¨æ˜ Harry çš„æ¯äº²æ˜¯ Lilyï¼Œçˆ¶äº²æ˜¯ Jamesï¼Œè€Œ `Trait` çš„ç©ºå•å…ƒæ ¼æ„å‘³ç€æˆ‘ä»¬ä¸çŸ¥é“ Harry æ˜¯å¦æœ‰è¿™ç§æ€§çŠ¶ã€‚åŒæ—¶ï¼ŒJames åœ¨æˆ‘ä»¬çš„æ•°æ®é›†ä¸­æ²¡æœ‰åˆ—å‡ºçˆ¶æ¯ï¼ˆå¦‚æ¯äº²å’Œçˆ¶äº²çš„ç©ºå•å…ƒæ ¼æ‰€ç¤ºï¼‰ï¼Œä½†ç¡®å®è¡¨ç°å‡ºäº†æ€§çŠ¶ï¼ˆå¦‚ `Trait` å•å…ƒæ ¼ä¸­çš„ 1 æ‰€ç¤ºï¼‰ã€‚å¦ä¸€æ–¹é¢ï¼ŒLily åœ¨æ•°æ®é›†ä¸­ä¹Ÿæ²¡æœ‰åˆ—å‡ºçˆ¶æ¯ï¼Œä½†æ²¡æœ‰è¡¨ç°å‡ºè¿™ç§æ€§çŠ¶ï¼ˆå¦‚ `Trait` å•å…ƒæ ¼ä¸­çš„ 0 è¡¨ç¤ºï¼‰ã€‚

æ‰“å¼€ `heredity.py`ï¼Œé¦–å…ˆçœ‹ä¸€ä¸‹ `PROBS` çš„å®šä¹‰ã€‚`PROBS` æ˜¯ä¸€ä¸ªåŒ…å«è‹¥å¹²å¸¸æ•°çš„å­—å…¸ï¼Œä»£è¡¨å„ç§ä¸åŒäº‹ä»¶çš„æ¦‚ç‡ã€‚æ‰€æœ‰è¿™äº›äº‹ä»¶éƒ½ä¸ä¸€ä¸ªäººæ‹¥æœ‰å¤šå°‘ä¸ªç‰¹å®šçš„çªå˜åŸºå› ï¼Œä»¥åŠä¸€ä¸ªäººæ˜¯å¦åŸºäºè¯¥åŸºå› è¡¨ç°å‡ºç‰¹å®šçš„æ€§çŠ¶æœ‰å…³ã€‚è¿™é‡Œçš„æ•°æ®æ¾æ•£åœ°åŸºäº GJB2 åŸºå› çš„å¬åŠ›éšœç¢ç‰ˆæœ¬å’Œå¬åŠ›éšœç¢æ€§çŠ¶çš„æ¦‚ç‡ï¼Œä½†é€šè¿‡æ”¹å˜è¿™äº›å€¼ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨ä½ çš„äººå·¥æ™ºèƒ½æ¥æ¨æ–­å…¶ä»–çš„åŸºå› å’Œæ€§çŠ¶ï¼

é¦–å…ˆï¼Œ`PROBS["gene"]` ä»£è¡¨äº†è¯¥åŸºå› çš„æ— æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒï¼ˆå³å¦‚æœæˆ‘ä»¬å¯¹è¯¥äººçš„çˆ¶æ¯ä¸€æ— æ‰€çŸ¥çš„æ¦‚ç‡ï¼‰ã€‚æ ¹æ®åˆ†å¸ƒä»£ç ä¸­çš„æ•°æ®ï¼Œåœ¨äººç¾¤ä¸­ï¼Œæœ‰ 1% çš„æœºä¼šæ‹¥æœ‰è¯¥åŸºå› çš„ 2 ä¸ªå‰¯æœ¬ï¼Œ3% çš„æœºä¼šæ‹¥æœ‰è¯¥åŸºå› çš„ 1 ä¸ªå‰¯æœ¬ï¼Œ96% çš„æœºä¼šæ‹¥æœ‰è¯¥åŸºå› çš„é›¶å‰¯æœ¬ã€‚

æ¥ä¸‹æ¥ï¼Œ`PROBS["trait"]` è¡¨ç¤ºä¸€ä¸ªäººè¡¨ç°å‡ºæŸç§æ€§çŠ¶ï¼ˆå¦‚å¬åŠ›éšœç¢ï¼‰çš„æ¡ä»¶æ¦‚ç‡ã€‚è¿™å®é™…ä¸Šæ˜¯ä¸‰ä¸ªä¸åŒçš„æ¦‚ç‡åˆ†å¸ƒï¼šåŸºå› çš„æ¯ä¸ªå¯èƒ½å€¼éƒ½æœ‰ä¸€ä¸ªã€‚å› æ­¤ï¼Œ`PROBS["trait"][2]` æ˜¯ä¸€ä¸ªäººåœ¨æœ‰ä¸¤ä¸ªçªå˜åŸºå› çš„æƒ…å†µä¸‹å…·æœ‰è¯¥ç‰¹å¾çš„æ¦‚ç‡åˆ†å¸ƒï¼šåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»–ä»¬æœ‰ 65% çš„æœºä¼šè¡¨ç°å‡ºè¯¥ç‰¹å¾ï¼Œè€Œæœ‰ 35% çš„æœºä¼šä¸è¡¨ç°å‡ºè¯¥ç‰¹å¾ã€‚åŒæ—¶ï¼Œå¦‚æœä¸€ä¸ªäººæœ‰ 0 ä¸ªå˜å¼‚åŸºå› ï¼Œä»–ä»¬æœ‰ 1% çš„æœºä¼šè¡¨ç°å‡ºè¯¥æ€§çŠ¶ï¼Œ99% çš„æœºä¼šä¸è¡¨ç°å‡ºè¯¥æ€§çŠ¶ã€‚

æœ€åï¼Œ`PROBS["mutation"]` æ˜¯ä¸€ä¸ªåŸºå› ä»ä½œä¸ºç›¸å…³åŸºå› çªå˜ä¸ºä¸æ˜¯è¯¥åŸºå› çš„æ¦‚ç‡ï¼Œåä¹‹äº¦ç„¶ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªæ¯äº²æœ‰ä¸¤ä¸ªå˜å¼‚åŸºå› ï¼Œå¹¶å› æ­¤å°†å…¶ä¸­ä¸€ä¸ªä¼ ç»™å¥¹çš„å­©å­ï¼Œå°±æœ‰ 1% çš„æœºä¼šçªå˜ä¸ºä¸å†æ˜¯å˜å¼‚åŸºå› ã€‚ç›¸åï¼Œå¦‚æœä¸€ä¸ªæ¯äº²æ²¡æœ‰ä»»ä½•å˜å¼‚åŸºå› ï¼Œå› æ­¤æ²¡æœ‰æŠŠå˜å¼‚åŸºå› ä¼ ç»™å¥¹çš„å­©å­ï¼Œä½†ä»æœ‰ 1% çš„æœºä¼šçªå˜ä¸ºå˜å¼‚åŸºå› ã€‚å› æ­¤ï¼Œå³ä½¿çˆ¶æ¯åŒæ–¹éƒ½æ²¡æœ‰å˜å¼‚åŸºå› ï¼Œä»–ä»¬çš„å­©å­ä¹Ÿå¯èƒ½æœ‰ 1 ä¸ªç”šè‡³ 2 ä¸ªå˜å¼‚åŸºå› ã€‚

æœ€ç»ˆï¼Œä½ è®¡ç®—çš„æ¦‚ç‡å°†ä»¥ `PROBS` ä¸­çš„è¿™äº›æ•°å€¼ä¸ºåŸºç¡€ã€‚

ç°åœ¨ï¼Œçœ‹ä¸€ä¸‹ `main` å‡½æ•°ã€‚è¯¥å‡½æ•°é¦–å…ˆå°†æ•°æ®ä»ä¸€ä¸ªæ–‡ä»¶åŠ è½½åˆ°ä¸€ä¸ªå­—å…¸ `people` ä¸­ã€‚`people` å°†æ¯ä¸ªäººçš„åå­—æ˜ å°„åˆ°å¦ä¸€ä¸ªåŒ…å«ä»–ä»¬ä¿¡æ¯çš„å­—å…¸ä¸­ï¼šåŒ…æ‹¬ä»–ä»¬çš„åå­—ï¼Œä»–ä»¬çš„æ¯äº²ï¼ˆå¦‚æœæ•°æ®é›†ä¸­æœ‰ä¸€ä¸ªæ¯äº²ï¼‰ï¼Œä»–ä»¬çš„çˆ¶äº²ï¼ˆå¦‚æœæ•°æ®é›†ä¸­æœ‰ä¸€ä¸ªçˆ¶äº²ï¼‰ï¼Œä»¥åŠä»–ä»¬æ˜¯å¦è¢«è§‚å¯Ÿåˆ°æœ‰ç›¸å…³çš„ç‰¹å¾ï¼ˆå¦‚æœæœ‰åˆ™ä¸º `True`ï¼Œæ²¡æœ‰åˆ™ä¸º `False`ï¼Œå¦‚æœæˆ‘ä»¬ä¸çŸ¥é“åˆ™ä¸º `None`ï¼‰ã€‚
æ¥ä¸‹æ¥ï¼Œ`main` ä¸­å®šä¹‰äº†ä¸€ä¸ªå­—å…¸ `probabilities`ï¼Œæ‰€æœ‰çš„æ¦‚ç‡æœ€åˆéƒ½è®¾ç½®ä¸º 0ã€‚è¿™å°±æ˜¯ä½ çš„é¡¹ç›®æœ€ç»ˆè¦è®¡ç®—çš„å†…å®¹ï¼šå¯¹äºæ¯ä¸ªäººï¼Œä½ çš„äººå·¥æ™ºèƒ½å°†è®¡ç®—ä»–ä»¬æœ‰å¤šå°‘ä¸ªå˜å¼‚åŸºå› çš„æ¦‚ç‡åˆ†å¸ƒï¼Œä»¥åŠä»–ä»¬æ˜¯å¦å…·æœ‰è¯¥æ€§çŠ¶ã€‚ä¾‹å¦‚ï¼Œ`probabilities["Harry"]["gene"][1]` å°†æ˜¯ Harry æœ‰ 1 ä¸ªå˜å¼‚åŸºå› çš„æ¦‚ç‡ï¼Œè€Œ `probabilities["Lily"]["trait"][False]` å°†æ˜¯ Lily æ²¡æœ‰è¡¨ç°å‡ºè¯¥æ€§çŠ¶çš„æ¦‚ç‡ã€‚

å¦‚æœä¸ç†Ÿæ‚‰çš„è¯ï¼Œè¿™ä¸ª `probabilities` å­—å…¸æ˜¯ç”¨ [python å­—å…¸](https://www.python.org/dev/peps/pep-0274/)åˆ›å»ºçš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä¸ºæˆ‘ä»¬çš„ `people` ä¸­çš„æ¯ä¸ª `person` åˆ›å»ºä¸€ä¸ªé”®/å€¼å¯¹ã€‚

æœ€ç»ˆï¼Œæˆ‘ä»¬å¸Œæœ›æ ¹æ®ä¸€äº›è¯æ®æ¥è®¡ç®—è¿™äº›æ¦‚ç‡ï¼šé‰´äºæˆ‘ä»¬çŸ¥é“æŸäº›äººæœ‰æˆ–æ²¡æœ‰è¿™ç§ç‰¹å¾ï¼Œæˆ‘ä»¬æƒ³ç¡®å®šè¿™äº›æ¦‚ç‡ã€‚ä½ åœ¨è¿™ä¸ªé¡¹ç›®ä¸­çš„ä»»åŠ¡æ˜¯å®ç°ä¸‰ä¸ªå‡½æ•°æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼š `joint_probability` è®¡ç®—ä¸€ä¸ªè”åˆæ¦‚ç‡ï¼Œ`update` å°†æ–°è®¡ç®—çš„è”åˆæ¦‚ç‡æ·»åŠ åˆ°ç°æœ‰çš„æ¦‚ç‡åˆ†å¸ƒä¸­ï¼Œç„¶å `normalize` ä»¥ç¡®ä¿æ‰€æœ‰æ¦‚ç‡åˆ†å¸ƒæœ€åå’Œä¸º 1ã€‚

## æ˜ç¡®

å®Œæˆ `joint_probability`ã€`update` å’Œ `normalize` çš„å®ç°ã€‚

`joint_probability` å‡½æ•°åº”è¯¥æ¥å—ä¸€ä¸ª `people` çš„å­—å…¸ä½œä¸ºè¾“å…¥ï¼Œä»¥åŠå…³äºè°æ‹¥æœ‰å¤šå°‘ä¸ªå˜å¼‚åŸºå› ï¼Œä»¥åŠè°è¡¨ç°å‡ºè¯¥ç‰¹å¾çš„æ•°æ®ã€‚è¯¥å‡½æ•°åº”è¯¥è¿”å›æ‰€æœ‰è¿™äº›äº‹ä»¶å‘ç”Ÿçš„è”åˆæ¦‚ç‡ã€‚

- è¯¥å‡½æ•°æ¥å—å››ä¸ªæ•°å€¼ä½œä¸ºè¾“å…¥ï¼š`people`, `one_gene`, `two_genes`, å’Œ `have_trait`ã€‚

  - `people` æ˜¯ä¸€ä¸ªåœ¨ "ç†è§£"ä¸€èŠ‚ä¸­æè¿°çš„äººçš„å­—å…¸ã€‚é”®ä»£è¡¨åå­—ï¼Œå€¼æ˜¯åŒ…å« `mother` å’Œ `father` é”®çš„å­—å…¸ã€‚ä½ å¯ä»¥å‡è®¾ `mother` å’Œ `father` éƒ½æ˜¯ç©ºç™½çš„ï¼ˆæ•°æ®é›†ä¸­æ²¡æœ‰çˆ¶æ¯çš„ä¿¡æ¯ï¼‰ï¼Œæˆ–è€… `mother` å’Œ `father` éƒ½ä¼šæŒ‡ä»£ `people` å­—å…¸ä¸­çš„å…¶ä»–äººç‰©ã€‚
  - `one_gene` æ˜¯ä¸€ä¸ªé›†åˆï¼Œæˆ‘ä»¬æƒ³è®¡ç®—æ‰€æœ‰é›†åˆå…ƒç´ æœ‰ä¸€ä¸ªå˜å¼‚åŸºå› çš„æ¦‚ç‡ã€‚
  - `two_genes` æ˜¯ä¸€ä¸ªé›†åˆï¼Œæˆ‘ä»¬æƒ³è®¡ç®—æ‰€æœ‰é›†åˆå…ƒç´ æœ‰ä¸¤ä¸ªå˜å¼‚åŸºå› çš„æ¦‚ç‡ã€‚
  - `have_trait` æ˜¯ä¸€ä¸ªé›†åˆï¼Œæˆ‘ä»¬æƒ³è®¡ç®—æ‰€æœ‰é›†åˆå…ƒç´ æ‹¥æœ‰è¯¥æ€§çŠ¶çš„æ¦‚ç‡ã€‚
  - å¯¹äºä¸åœ¨ `one_gene` æˆ– `two_genes` ä¸­çš„äººï¼Œæˆ‘ä»¬æƒ³è®¡ç®—ä»–ä»¬æ²¡æœ‰å˜å¼‚åŸºå› çš„æ¦‚ç‡ï¼›å¯¹äºä¸åœ¨ `have_trait` ä¸­çš„äººï¼Œæˆ‘ä»¬æƒ³è®¡ç®—ä»–ä»¬æ²¡æœ‰è¯¥æ€§çŠ¶çš„æ¦‚ç‡ã€‚

- ä¾‹å¦‚ï¼Œå¦‚æœè¿™ä¸ªå®¶åº­ç”± Harryã€James å’Œ Lily ç»„æˆï¼Œé‚£ä¹ˆåœ¨ `one_gene = {"Harry"}`ã€`two_genes = {"James"}` å’Œ `trait = {"Harry"ã€"James"}` çš„æƒ…å†µä¸‹è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œåº”è¯¥è®¡ç®—å‡º Lily æ²¡æœ‰å˜å¼‚åŸºå› ã€Harry æ‹¥æœ‰ä¸€ä¸ªå˜å¼‚åŸºå› ã€James æ‹¥æœ‰ä¸¤ä¸ªå˜å¼‚åŸºå› ã€Harry è¡¨ç°å‡ºè¯¥æ€§çŠ¶ã€James è¡¨ç°å‡ºè¯¥æ€§çŠ¶å’Œ Lily æ²¡æœ‰è¡¨ç°å‡ºè¯¥æ€§çŠ¶çš„è”åˆæ¦‚ç‡ã€‚
- å¯¹äºæ•°æ®é›†ä¸­æ²¡æœ‰åˆ—å‡ºçˆ¶æ¯çš„äººï¼Œä½¿ç”¨æ¦‚ç‡åˆ†å¸ƒ `PROBS["gene"]` æ¥ç¡®å®šä»–ä»¬æœ‰ç‰¹å®šæ•°é‡åŸºå› çš„æ¦‚ç‡ã€‚
- å¯¹äºæ•°æ®é›†ä¸­æœ‰çˆ¶æ¯çš„äººæ¥è¯´ï¼Œæ¯ä¸ªçˆ¶æ¯éƒ½ä¼šæŠŠä»–ä»¬çš„ä¸¤ä¸ªåŸºå› ä¸­çš„ä¸€ä¸ªéšæœºåœ°ä¼ ç»™ä»–ä»¬çš„å­©å­ï¼Œè€Œä¸”æœ‰ä¸€ä¸ª `PROBS["mutation"]` çš„æœºä¼šï¼Œå³å®ƒä¼šå‘ç”Ÿçªå˜ï¼ˆä»å˜å¼‚åŸºå› å˜æˆæ­£å¸¸åŸºå› ï¼Œæˆ–è€…ç›¸åï¼‰ã€‚
- ä½¿ç”¨æ¦‚ç‡åˆ†å¸ƒ `PROBS["trait"]` æ¥è®¡ç®—ä¸€ä¸ªäººå…·æœ‰æˆ–ä¸å…·æœ‰å½¢çŠ¶çš„æ¦‚ç‡ã€‚

`update` å‡½æ•°å°†ä¸€ä¸ªæ–°çš„è”åˆåˆ†å¸ƒæ¦‚ç‡æ·»åŠ åˆ° `probabilities` ä¸­çš„ç°æœ‰æ¦‚ç‡åˆ†å¸ƒä¸­ã€‚

- è¯¥å‡½æ•°æ¥å—äº”ä¸ªå€¼ä½œä¸ºè¾“å…¥ï¼š`probabilities`, `one_gene`, `two_genes`, `have_trait`, å’Œ `p`ã€‚

  - `probabilities` æ˜¯ä¸€ä¸ªåœ¨ "ç†è§£ "éƒ¨åˆ†æåˆ°çš„å­—å…¸ã€‚æ¯ä¸ªäººéƒ½è¢«æ˜ å°„åˆ°ä¸€ä¸ª `"gene"` åˆ†å¸ƒå’Œä¸€ä¸ª `"trait"` åˆ†å¸ƒã€‚
  - `one_gene` æ˜¯ä¸€ä¸ªé›†åˆï¼Œæˆ‘ä»¬æƒ³è®¡ç®—æ‰€æœ‰é›†åˆå…ƒç´ æœ‰ä¸€ä¸ªå˜å¼‚åŸºå› çš„æ¦‚ç‡ã€‚
  - `two_genes` æ˜¯ä¸€ä¸ªé›†åˆï¼Œæˆ‘ä»¬æƒ³è®¡ç®—æ‰€æœ‰é›†åˆå…ƒç´ æœ‰ä¸¤ä¸ªå˜å¼‚åŸºå› çš„æ¦‚ç‡ã€‚
  - `have_trait` æ˜¯ä¸€ä¸ªé›†åˆï¼Œæˆ‘ä»¬æƒ³è®¡ç®—æ‰€æœ‰é›†åˆå…ƒç´ æ‹¥æœ‰è¯¥æ€§çŠ¶çš„æ¦‚ç‡ã€‚
  - `p` æ˜¯è”åˆåˆ†å¸ƒçš„æ¦‚ç‡ã€‚
- å¯¹äºæ¦‚ç‡ä¸­çš„æ¯ä¸ªäººï¼Œè¯¥å‡½æ•°åº”è¯¥æ›´æ–° `probabilities[person]["gene"]` åˆ†å¸ƒå’Œ `probabilities[person]["trait"]` åˆ†å¸ƒï¼Œåœ¨æ¯ä¸ªåˆ†å¸ƒä¸­çš„é€‚å½“æ•°å€¼ä¸ŠåŠ ä¸Š `p`ã€‚æ‰€æœ‰å…¶ä»–æ•°å€¼åº”ä¿æŒä¸å˜ã€‚
- ä¾‹å¦‚ï¼Œå¦‚æœ"Harry"åŒæ—¶å‡ºç°åœ¨ `two_genes` å’Œ `have_trait` ä¸­ï¼Œé‚£ä¹ˆ `p` å°†è¢«æ·»åŠ åˆ° `probabilities["Harry"]["gene"][2]` å’Œ `probabilities["Harry"]["trait"][True]`ã€‚
- è¯¥å‡½æ•°ä¸åº”è¿”å›ä»»ä½•å€¼ï¼šå®ƒåªéœ€è¦æ›´æ–° `probabilities` å­—å…¸ã€‚

`normalize` å‡½æ•°æ›´æ–° `probabilities` å­—å…¸ï¼Œä½¿æ¯ä¸ªæ¦‚ç‡åˆ†å¸ƒè¢«å½’ä¸€åŒ–ï¼ˆå³å’Œä¸º 1ï¼Œç›¸å¯¹æ¯”ä¾‹ç›¸åŒï¼‰ã€‚

- è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªå•ä¸€çš„å€¼ï¼š`probabilities`ã€‚

  - `probabilities` æ˜¯ä¸€ä¸ªåœ¨"ç†è§£"éƒ¨åˆ†æåˆ°çš„å­—å…¸ã€‚æ¯ä¸ªäººéƒ½è¢«æ˜ å°„åˆ°ä¸€ä¸ª `"gene"` åˆ†å¸ƒå’Œä¸€ä¸ª `"trait"` åˆ†å¸ƒã€‚
- å¯¹äº `probabilities` ä¸­æ¯ä¸ªäººçš„ä¸¤ä¸ªåˆ†å¸ƒï¼Œè¿™ä¸ªå‡½æ•°åº”è¯¥å°†è¯¥åˆ†å¸ƒå½’ä¸€åŒ–ï¼Œä½¿åˆ†å¸ƒä¸­çš„æ•°å€¼ä¹‹å’Œä¸º 1ï¼Œåˆ†å¸ƒä¸­çš„ç›¸å¯¹æ•°å€¼æ˜¯ç›¸åŒçš„ã€‚
- ä¾‹å¦‚ï¼Œå¦‚æœ `probabilities["Harry"]["trait"][True]` ç­‰äº `0.1`ï¼Œæ¦‚ç‡ `probabilities["Harry"]["trait"][False]` ç­‰äº `0.3`ï¼Œé‚£ä¹ˆä½ çš„å‡½æ•°åº”è¯¥å°†å‰ä¸€ä¸ªå€¼æ›´æ–°ä¸º `0.25`ï¼Œåä¸€ä¸ªå€¼æ›´æ–°ä¸º `0.75`: ç°åœ¨æ•°å­—ä¹‹å’Œä¸º 1ï¼Œè€Œä¸”åä¸€ä¸ªå€¼ä»ç„¶æ¯”å‰ä¸€ä¸ªå€¼å¤§ä¸‰å€ã€‚
- è¯¥å‡½æ•°ä¸åº”è¿”å›ä»»ä½•å€¼ï¼šå®ƒåªéœ€è¦æ›´æ–° `probabilities` å­—å…¸ã€‚

é™¤äº†è§„èŒƒä¸­è¦æ±‚ä½ å®ç°çš„ä¸‰ä¸ªå‡½æ•°å¤–ï¼Œä½ ä¸åº”è¯¥ä¿®æ”¹ `heredity.py` ä¸­çš„ä»»ä½•å…¶ä»–ä¸œè¥¿ï¼Œå°½ç®¡ä½ å¯ä»¥ç¼–å†™é¢å¤–çš„å‡½æ•°å’Œ/æˆ–å¯¼å…¥å…¶ä»– Python æ ‡å‡†åº“æ¨¡å—ã€‚å¦‚æœç†Ÿæ‚‰çš„è¯ï¼Œä½ ä¹Ÿå¯ä»¥å¯¼å…¥ `numpy` æˆ– `pandas`ï¼Œä½†æ˜¯ä½ ä¸åº”è¯¥ä½¿ç”¨ä»»ä½•å…¶ä»–ç¬¬ä¸‰æ–¹ Python æ¨¡å—ã€‚

## ä¸€ä¸ªè”åˆæ¦‚ç‡ä¾‹å­

ä¸ºäº†å¸®åŠ©ä½ æ€è€ƒå¦‚ä½•è®¡ç®—è”åˆæ¦‚ç‡ï¼Œæˆ‘ä»¬åœ¨ä¸‹é¢é™„ä¸Šä¸€ä¸ªä¾‹å­ã€‚

è¯·è€ƒè™‘ä»¥ä¸‹ `people` çš„å€¼ï¼š

```python
{
  'Harry': {'name': 'Harry', 'mother': 'Lily', 'father': 'James', 'trait': None},
  'James': {'name': 'James', 'mother': None, 'father': None, 'trait': True},
  'Lily': {'name': 'Lily', 'mother': None, 'father': None, 'trait': False}
}
```

è¿™é‡Œæˆ‘ä»¬å°†å±•ç¤º `joint_probability(people, {"Harry"}, {"James"}, {"James"})` çš„è®¡ç®—ã€‚æ ¹æ®å‚æ•°ï¼Œ`one_gene` æ˜¯ `{"Harry"}`ï¼Œ`two_genes` æ˜¯ `{"James"}`ï¼Œè€Œ `has_trait` æ˜¯ `{"James"}`ã€‚å› æ­¤ï¼Œè¿™ä»£è¡¨äº†ä»¥ä¸‹çš„æ¦‚ç‡ï¼šLily æ²¡æœ‰å˜å¼‚åŸºå› ï¼Œä¸å…·æœ‰è¯¥æ€§çŠ¶ï¼›Harry æœ‰ä¸€ä¸ªå˜å¼‚åŸºå› ï¼Œä¸å…·æœ‰è¯¥æ€§çŠ¶ï¼›James æœ‰ 2 ä¸ªå˜å¼‚åŸºå› ï¼Œå…·æœ‰è¯¥æ€§çŠ¶ã€‚

æˆ‘ä»¬ä» Lily å¼€å§‹ï¼ˆæˆ‘ä»¬è€ƒè™‘äººçš„é¡ºåºå¹¶ä¸é‡è¦ï¼Œåªè¦æˆ‘ä»¬æŠŠæ­£ç¡®çš„æ•°å€¼ä¹˜åœ¨ä¸€èµ·ï¼Œå› ä¸ºä¹˜æ³•æ˜¯å¯äº¤æ¢çš„ï¼‰ã€‚Lily æ²¡æœ‰å˜å¼‚åŸºå› ï¼Œæ¦‚ç‡ä¸º `0.96`ï¼ˆè¿™å°±æ˜¯ `PROBS["gene"][0]`ï¼‰ã€‚é‰´äºå¥¹æ²¡æœ‰å˜å¼‚åŸºå› ï¼Œå¥¹æ²¡æœ‰è¿™ä¸ªæ€§çŠ¶çš„æ¦‚ç‡ä¸º `0.99`ï¼ˆè¿™æ˜¯ `PROBS["trait"][0][False]`ï¼‰ã€‚å› æ­¤ï¼Œå¥¹æ²¡æœ‰å˜å¼‚åŸºå› ä¸”æ²¡æœ‰è¯¥æ€§çŠ¶çš„æ¦‚ç‡æ˜¯ `0.96*0.99=0.9504`ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è€ƒè™‘ Jamesã€‚James æœ‰ 2 ä¸ªå˜å¼‚åŸºå› ï¼Œæ¦‚ç‡ä¸º `0.01`ï¼ˆè¿™æ˜¯ `PROBS["gene"][2]`ï¼‰ã€‚é‰´äºä»–æœ‰ 2 ä¸ªå˜å¼‚åŸºå› ï¼Œä»–ç¡®å®å…·æœ‰è¯¥æ€§çŠ¶çš„æ¦‚ç‡ä¸º `0.65`ã€‚å› æ­¤ï¼Œä»–æœ‰ 2 ä¸ªå˜å¼‚åŸºå› å¹¶ä¸”ä»–ç¡®å®å…·æœ‰è¯¥æ€§çŠ¶çš„æ¦‚ç‡æ˜¯ `0.01*0.65=0.0065`ã€‚

æœ€åï¼Œæˆ‘ä»¬è€ƒè™‘ Harryã€‚Harry æœ‰ 1 ä¸ªå˜å¼‚åŸºå› çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿæœ‰ä¸¤ç§æƒ…å†µå¯ä»¥å‘ç”Ÿã€‚è¦ä¹ˆä»–ä»æ¯äº²é‚£é‡Œå¾—åˆ°è¿™ä¸ªåŸºå› ï¼Œè€Œä¸æ˜¯ä»çˆ¶äº²é‚£é‡Œï¼Œè¦ä¹ˆä»–ä»çˆ¶äº²é‚£é‡Œå¾—åˆ°è¿™ä¸ªåŸºå› ï¼Œè€Œä¸æ˜¯ä»æ¯äº²é‚£é‡Œã€‚ä»–çš„æ¯äº² Lily æ²¡æœ‰å˜å¼‚åŸºå› ï¼Œæ‰€ä»¥ Harry ä¼šä»¥ `0.01` çš„æ¦‚ç‡ä»ä»–æ¯äº²é‚£é‡Œå¾—åˆ°è¿™ä¸ªåŸºå› ï¼ˆè¿™æ˜¯ `PROBS["mutation"]`ï¼‰ï¼Œå› ä¸ºä»ä»–æ¯äº²é‚£é‡Œå¾—åˆ°è¿™ä¸ªåŸºå› çš„å”¯ä¸€é€”å¾„æ˜¯åŸºå› çªå˜ï¼›ç›¸åï¼ŒHarry ä¸ä¼šä»ä»–æ¯äº²é‚£é‡Œå¾—åˆ°è¿™ä¸ªåŸºå› ï¼Œæ¦‚ç‡æ˜¯ `0.99`ã€‚ä»–çš„çˆ¶äº² James æœ‰ 2 ä¸ªå˜å¼‚åŸºå› ï¼Œæ‰€ä»¥ Harry ä¼šä»¥ `0.99` çš„æ¦‚ç‡ä»ä»–çˆ¶äº²é‚£é‡Œå¾—åˆ°è¿™ä¸ªåŸºå› ï¼ˆè¿™æ˜¯ `1-PROBS["mutation"]`ï¼‰ï¼Œä½†ä¼šä»¥ `0.01` çš„æ¦‚ç‡ä»ä»–æ¯äº²é‚£é‡Œå¾—åˆ°è¿™ä¸ªåŸºå› ï¼ˆçªå˜çš„æ¦‚ç‡ï¼‰ã€‚è¿™ä¸¤ç§æƒ…å†µåŠ åœ¨ä¸€èµ·å¯ä»¥å¾—åˆ° `0.99*0.99+0.01*0.01=0.9802`ï¼Œå³ Harry æœ‰ 1 ä¸ªå˜å¼‚åŸºå› çš„æ¦‚ç‡ã€‚

è€ƒè™‘åˆ° Harry æœ‰ 1 ä¸ªå˜å¼‚åŸºå› ï¼Œä»–æ²¡æœ‰è¯¥æ€§çŠ¶çš„æ¦‚ç‡æ˜¯ `0.44`ï¼ˆè¿™æ˜¯ `PROBS["trait"][1][false]`ï¼‰ã€‚å› æ­¤ï¼Œå“ˆåˆ©æœ‰ 1 ä¸ªå˜å¼‚åŸºå› è€Œæ²¡æœ‰è¯¥æ€§çŠ¶çš„æ¦‚ç‡æ˜¯ `0.9802 * 0.44 = 0.431288`ã€‚

å› æ­¤ï¼Œæ•´ä¸ªè”åˆæ¦‚ç‡æ˜¯ä¸‰ä¸ªäººä¸­æ¯ä¸ªäººçš„æ‰€æœ‰è¿™äº›æ•°å€¼ç›¸ä¹˜çš„ç»“æœï¼š`0.9504 * 0.0065 * 0.431288 = 0.0026643247488`ã€‚

## æç¤º

- å›é¡¾ä¸€ä¸‹ï¼Œè¦è®¡ç®—å¤šä¸ªäº‹ä»¶çš„è”åˆæ¦‚ç‡ï¼Œä½ å¯ä»¥é€šè¿‡å°†è¿™äº›æ¦‚ç‡ç›¸ä¹˜æ¥å®ç°ã€‚ä½†è¯·è®°ä½ï¼Œå¯¹äºä»»ä½•å­©å­æ¥è¯´ï¼Œä»–ä»¬æ‹¥æœ‰ä¸€å®šæ•°é‡çš„åŸºå› çš„æ¦‚ç‡æ˜¯ä»¥ä»–ä»¬çš„çˆ¶æ¯æ‹¥æœ‰ä»€ä¹ˆåŸºå› ä¸ºæ¡ä»¶çš„ã€‚



## æ£€æŸ¥æ–¹æ³•

```bash
check50 ai50/projects/2024/x/heredity --offline
```



## æ ·ä¾‹ä»£ç 

```python
import csv
import itertools
import sys

PROBS = {

    # Unconditional probabilities for having gene
    "gene": {
        2: 0.01,
        1: 0.03,
        0: 0.96
    },

    "trait": {

        # Probability of trait given two copies of gene
        2: {
            True: 0.65,
            False: 0.35
        },

        # Probability of trait given one copy of gene
        1: {
            True: 0.56,
            False: 0.44
        },

        # Probability of trait given no gene
        0: {
            True: 0.01,
            False: 0.99
        }
    },

    # Mutation probability
    "mutation": 0.01
}


def main():

    # Check for proper usage
    if len(sys.argv) != 2:
        sys.exit("Usage: python heredity.py data.csv")
    people = load_data(sys.argv[1])

    # Keep track of gene and trait probabilities for each person
    probabilities = {
        person: {
            "gene": {
                2: 0,
                1: 0,
                0: 0
            },
            "trait": {
                True: 0,
                False: 0
            }
        }
        for person in people
    }

    # Loop over all sets of people who might have the trait
    names = set(people)
    for have_trait in powerset(names):

        # Check if current set of people violates known information
        fails_evidence = any(
            (people[person]["trait"] is not None and
             people[person]["trait"] != (person in have_trait))
            for person in names
        )
        if fails_evidence:
            continue

        # Loop over all sets of people who might have the gene
        for one_gene in powerset(names):
            for two_genes in powerset(names - one_gene):

                # Update probabilities with new joint probability
                p = joint_probability(people, one_gene, two_genes, have_trait)
                update(probabilities, one_gene, two_genes, have_trait, p)

    # Ensure probabilities sum to 1
    normalize(probabilities)

    # Print results
    for person in people:
        print(f"{person}:")
        for field in probabilities[person]:
            print(f"  {field.capitalize()}:")
            for value in probabilities[person][field]:
                p = probabilities[person][field][value]
                print(f"    {value}: {p:.4f}")


def load_data(filename):
    """
    Load gene and trait data from a file into a dictionary.
    File assumed to be a CSV containing fields name, mother, father, trait.
    mother, father must both be blank, or both be valid names in the CSV.
    trait should be 0 or 1 if trait is known, blank otherwise.
    """
    data = dict()
    with open(filename) as f:
        reader = csv.DictReader(f)
        for row in reader:
            name = row["name"]
            data[name] = {
                "name": name,
                "mother": row["mother"] or None,
                "father": row["father"] or None,
                "trait": (True if row["trait"] == "1" else
                          False if row["trait"] == "0" else None)
            }
    return data


def powerset(s):
    """
    Return a list of all possible subsets of set s.
    """
    s = list(s)
    return [
        set(s) for s in itertools.chain.from_iterable(
            itertools.combinations(s, r) for r in range(len(s) + 1)
        )
    ]


def joint_probability(people, one_gene, two_genes, have_trait):
    """
    Compute and return a joint probability.

    The probability returned should be the probability that
        * everyone in set `one_gene` has one copy of the gene, and
        * everyone in set `two_genes` has two copies of the gene, and
        * everyone not in `one_gene` or `two_gene` does not have the gene, and
        * everyone in set `have_trait` has the trait, and
        * everyone not in set` have_trait` does not have the trait.
    """
    probability=1.0
    for person in people:
        if people[person]["mother"] is None:
            if person in one_gene:
                probability*=PROBS["gene"][1]
                if person in have_trait:
                    probability*=PROBS["trait"][1][True]
                else:
                    probability*=PROBS["trait"][1][False]
            elif person in two_genes:
                probability*=PROBS["gene"][2]
                if person in have_trait:
                    probability*=PROBS["trait"][2][True]
                else:
                    probability*=PROBS["trait"][2][False]
            else:
                probability*=PROBS["gene"][0]
                if person in have_trait:
                    probability*=PROBS["trait"][0][True]
                else:
                    probability*=PROBS["trait"][0][False]
            
        else:
            num_father=0
            num_mather=0
            if people[person]["mother"] in one_gene:
                num_mather=1
            elif people[person]["mother"] in two_genes:
                num_mather=2
            if people[person]["father"] in one_gene:
                num_father=1
            elif people[person]["father"] in two_genes:
                num_father=2
            pro_father=num_father/2
            pro_mather=num_mather/2
            pro_2=pro_father*pro_mather*(1-PROBS["mutation"])*(1-PROBS["mutation"])+\
                (1-pro_father)*(1-pro_mather)*PROBS["mutation"]*PROBS["mutation"]+\
                    pro_father*(1-pro_mather)*PROBS["mutation"]*(1-PROBS["mutation"])+\
                    pro_mather*(1-pro_father)*PROBS["mutation"]*(1-PROBS["mutation"])
            pro_0=(1-pro_father)*(1-pro_mather)*(1-PROBS["mutation"])*(1-PROBS["mutation"])+\
                pro_father*(1-pro_mather)*(1-PROBS["mutation"])*PROBS["mutation"]+\
                pro_mather*(1-pro_father)*(1-PROBS["mutation"])*PROBS["mutation"]+\
                pro_mather*pro_father*PROBS["mutation"]*PROBS["mutation"]
            pro_1=1-pro_0-pro_2
            if person in one_gene:
                probability*=pro_1
                if person in have_trait:
                    probability*=PROBS["trait"][1][True]
                else:
                    probability*=PROBS["trait"][1][False]
            elif person in two_genes:
                probability*=pro_2
                if person in have_trait:
                    probability*=PROBS["trait"][2][True]
                else:
                    probability*=PROBS["trait"][2][False]
            else:
                probability*=pro_0
                if person in have_trait:
                    probability*=PROBS["trait"][0][True]
                else:
                    probability*=PROBS["trait"][0][False]
    return probability
            




def update(probabilities, one_gene, two_genes, have_trait, p):
    """
    Add to `probabilities` a new joint probability `p`.
    Each person should have their "gene" and "trait" distributions updated.
    Which value for each distribution is updated depends on whether
    the person is in `have_gene` and `have_trait`, respectively.
    """
    for person in probabilities:
        if person in one_gene:
            probabilities[person]["gene"][1]+=p
        elif person in two_genes:
            probabilities[person]["gene"][2]+=p
        else:
            probabilities[person]["gene"][0]+=p
        if person in have_trait:
            probabilities[person]["trait"][True]+=p
        else:
            probabilities[person]["trait"][False]+=p

def normalize(probabilities):
    """
    Update `probabilities` such that each probability distribution
    is normalized (i.e., sums to 1, with relative proportions the same).
    """
    for person in probabilities:
        sum_gene=sum(probabilities[person]["gene"].values())
        sum_trait=sum(probabilities[person]["trait"].values())
        for i in range(3):
            probabilities[person]["gene"][i]/=sum_gene
        for i in range(2):
            probabilities[person]["trait"][i]/=sum_trait


if __name__ == "__main__":
    main()

```

