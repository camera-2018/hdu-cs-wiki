# ç¨‹åºç¤ºä¾‹â€”â€”maze è¿·å®«è§£æœç´¢

::: warning ğŸ˜‹
é˜…è¯»ç¨‹åºä¸­æ¶‰åŠæœç´¢ç®—æ³•çš„éƒ¨åˆ†ï¼Œç„¶åè¿è¡Œç¨‹åºï¼Œäº«å—æœºå™¨è‡ªåŠ¨å¸®ä½ å¯»æ‰¾è·¯å¾„çš„å¿«ä¹ï¼
å®Œæˆä¹ é¢˜
:::

::: tip ğŸ“¥
æœ¬èŠ‚é™„ä»¶ä¸‹è½½ <Download url="https://cdn.xyxsw.site/code/1-Lecture.zip"/>
:::

## Node

```python
# èŠ‚ç‚¹ç±» Node
class Node:
    def __init__(self, state, parent, action):
        self.state = state        # å­˜å‚¨è¯¥ç»“ç‚¹çš„è¿·å®«çŠ¶æ€ï¼ˆå³ä½ç½®ï¼‰
        self.parent = parent      # å­˜å‚¨çˆ¶ç»“ç‚¹
        self.action = action      # å­˜å‚¨é‡‡å–çš„è¡ŒåŠ¨
```

## èŠ‚ç‚¹å¤ä¹ 

- èŠ‚ç‚¹æ˜¯ä¸€ç§åŒ…å«ä»¥ä¸‹æ•°æ®çš„æ•°æ®ç»“æ„ï¼š
  - çŠ¶æ€â€”â€”state
  - å…¶çˆ¶èŠ‚ç‚¹ï¼Œé€šè¿‡è¯¥çˆ¶èŠ‚ç‚¹ç”Ÿæˆå½“å‰èŠ‚ç‚¹â€”â€”parent node
  - åº”ç”¨äºçˆ¶çº§çŠ¶æ€ä»¥è·å–å½“å‰èŠ‚ç‚¹çš„æ“ä½œâ€”â€”action
  - ä»åˆå§‹çŠ¶æ€åˆ°è¯¥èŠ‚ç‚¹çš„è·¯å¾„æˆæœ¬â€”â€”path cost

## å †æ ˆè¾¹åŸŸâ€”â€”DFS

```python
class StackFrontier:  # å †æ ˆè¾¹åŸŸ
    def __init__(self):
        self.frontier = []  # è¾¹åŸŸ
    def add(self, node):  # å †æ ˆæ·»åŠ ç»“ç‚¹
        self.frontier.append(node)
    def contains_state(self, state):
        return any(node.state == state for node in self.frontier)
    def empty(self):  # åˆ¤æ–­è¾¹åŸŸä¸ºç©º
        return len(self.frontier) == 0
    def remove(self):  # ç§»é™¤ç»“ç‚¹
        if self.empty():
            raise Exception("empty frontier")
        else:
            node = self.frontier[-1]
            self.frontier = self.frontier[:-1]
            return node
```

## æ·±åº¦ä¼˜å…ˆæœç´¢å¤ä¹ 

- æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•åœ¨å°è¯•å¦ä¸€ä¸ªæ–¹å‘ä¹‹å‰è€—å°½æ¯ä¸ªæ–¹å‘ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œè¾¹åŸŸä½œä¸ºå †æ ˆæ•°æ®ç»“æ„è¿›è¡Œç®¡ç†ã€‚è¿™é‡Œéœ€è¦è®°ä½çš„æµè¡Œè¯­æ˜¯â€œåè¿›å…ˆå‡ºâ€ã€‚åœ¨å°†èŠ‚ç‚¹æ·»åŠ åˆ°è¾¹åŸŸåï¼Œç¬¬ä¸€ä¸ªè¦åˆ é™¤å’Œè€ƒè™‘çš„èŠ‚ç‚¹æ˜¯æœ€åä¸€ä¸ªè¦æ·»åŠ çš„èŠ‚ç‚¹ã€‚è¿™å¯¼è‡´äº†ä¸€ç§æœç´¢ç®—æ³•ï¼Œè¯¥ç®—æ³•åœ¨ç¬¬ä¸€ä¸ªæ–¹å‘ä¸Šå°½å¯èƒ½æ·±å…¥ï¼Œç›´åˆ°å°½å¤´ï¼ŒåŒæ—¶å°†æ‰€æœ‰å…¶ä»–æ–¹å‘ç•™åˆ°åé¢ã€‚â€œä¸æ’å—å¢™ä¸å›å¤´â€

## é˜Ÿåˆ—è¾¹åŸŸâ€”â€”BFS

```python
class QueueFrontier(StackFrontier):  # é˜Ÿåˆ—è¾¹åŸŸ
    def remove(self):
        if self.empty():
            raise Exception("empty frontier")
        else:
            node = self.frontier[0]
            self.frontier = self.frontier[1:]
            return node
```

## å¹¿åº¦ä¼˜å…ˆæœç´¢å¤ä¹ 

- å¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³•å°†åŒæ—¶éµå¾ªå¤šä¸ªæ–¹å‘ï¼Œåœ¨æ¯ä¸ªå¯èƒ½çš„æ–¹å‘ä¸Šè¿ˆå‡ºä¸€æ­¥ï¼Œç„¶ååœ¨æ¯ä¸ªæ–¹å‘ä¸Šè¿ˆå‡ºç¬¬äºŒæ­¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¾¹åŸŸä½œä¸ºé˜Ÿåˆ—æ•°æ®ç»“æ„è¿›è¡Œç®¡ç†ã€‚è¿™é‡Œéœ€è¦è®°ä½çš„æµè¡Œè¯­æ˜¯â€œå…ˆè¿›å…ˆå‡ºâ€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æ–°èŠ‚ç‚¹éƒ½ä¼šæ’æˆä¸€è¡Œï¼Œå¹¶æ ¹æ®å…ˆæ·»åŠ çš„èŠ‚ç‚¹æ¥è€ƒè™‘èŠ‚ç‚¹ï¼ˆå…ˆåˆ°å…ˆå¾—ï¼ï¼‰ã€‚è¿™å¯¼è‡´æœç´¢ç®—æ³•åœ¨ä»»ä½•ä¸€ä¸ªæ–¹å‘ä¸Šè¿ˆå‡ºç¬¬äºŒæ­¥ä¹‹å‰ï¼Œåœ¨æ¯ä¸ªå¯èƒ½çš„æ–¹å‘ä¸Šè¿ˆå‡ºä¸€æ­¥ã€‚

## è¿·å®«è§£â€”â€”Maze_solution

```python
class Maze:
    def __init__(self, filename):  # è¯»å…¥è¿·å®«å›¾
        # è¯»å…¥æ–‡ä»¶ï¼Œè®¾ç½®è¿·å®«å¤§å°
        with open(filename) as f:
            contents = f.read()
        # éªŒè¯èµ·ç‚¹å’Œç›®æ ‡
        if contents.count("A") != 1:
            raise Exception("maze must have exactly one start point")
        if contents.count("B") != 1:
            raise Exception("maze must have exactly one goal")
        # ç»˜åˆ¶è¿·å®«å¤§å°
        contents = contents.splitlines()
        self.height = len(contents)
        self.width = max(len(line) for line in contents)
        # ç»˜åˆ¶è¿·å®«å¢™ï¼Œèµ·ç‚¹ï¼Œç»ˆç‚¹
        self.walls = []
        for i in range(self.height):
            row = []
            for j in range(self.width):
                try:
                    if contents[i][j] == "A":    # è®¾ç½®èµ·ç‚¹
                        self.start = (i, j)
                        row.append(False)
                    elif contents[i][j] == "B":
                        self.goal = (i, j)       # è®¾ç½®ç»ˆç‚¹
                        row.append(False)
                    elif contents[i][j] == " ":
                        row.append(False)        # è®¾ç½®å¢™ä½“
                    else:
                        row.append(True)         # å¯ç§»åŠ¨çš„ç‚¹ä¸º True
                except IndexError:
                    row.append(False)
            self.walls.append(row)
        self.solution = None
    # æ‰“å°ç»“æœ
    def print(self):
        ...
    # å¯»æ‰¾é‚»ç»“ç‚¹ï¼Œè¿”å›å…ƒç»„ (åŠ¨ä½œï¼Œåæ ‡ (x,y))
    def neighbors(self, state):
        row, col = state
        candidates = [
            ("up", (row - 1, col)),
            ("down", (row + 1, col)),
            ("left", (row, col - 1)),
            ("right", (row, col + 1))
        ]
        result = []
        for action, (r, c) in candidates:
            if 0 <= r < self.height and 0 <= c < self.width and not self.walls[r][c]:
                result.append((action, (r, c)))
        return result
    def solve(self):
        # æœç´¢è¿·å®«è§£
        self.num_explored = 0   # å·²æœç´¢çš„è·¯å¾„é•¿åº¦
        # å°†è¾¹ç•Œåˆå§‹åŒ–ä¸ºèµ·å§‹ä½ç½®
        start = Node(state=self.start, parent=None, action=None)
        frontier = StackFrontier()  # é‡‡ç”¨ DFS
        # frontier = QueueFrontier()  # é‡‡ç”¨ BFS
        frontier.add(start)
        # åˆå§‹åŒ–ä¸€ä¸ªç©ºçš„æ¢ç´¢é›†
        self.explored = set()  # å­˜å‚¨å·²æœç´¢çš„ç»“ç‚¹
        # ä¿æŒå¾ªç¯ç›´åˆ°æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ
        while True:
            # æ— è§£æƒ…å†µ
            if frontier.empty():
                raise Exception("no solution")
            # ä»è¾¹ç•Œä¸­é€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹
            node = frontier.remove()
            self.num_explored += 1
            # å¾—åˆ°è§£å†³è·¯å¾„
            if node.state == self.goal:
                actions = []
                cells = []
                while node.parent is not None:  # éå†çˆ¶èŠ‚ç‚¹å¾—åˆ°è·¯å¾„åŠ¨ä½œ
                    actions.append(node.action)
                    cells.append(node.state)
                    node = node.parent
                actions.reverse()
                cells.reverse()
                self.solution = (actions, cells)
                return
            # å°†èŠ‚ç‚¹æ ‡è®°ä¸ºå·²æ¢ç´¢
            self.explored.add(node.state)
            # å°†é‚»å±…æ·»åŠ åˆ°è¾¹ç•Œï¼ˆå±•å¼€èŠ‚ç‚¹ï¼‰
            for action, state in self.neighbors(node.state):
                if not frontier.contains_state(state) and state not in self.explored:
                    child = Node(state=state, parent=node, action=action)
                    frontier.add(child)
    def output_image(self, filename, show_solution=True, show_explored=False):
        ...
```

## Quiz

1. åœ¨æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰å’Œå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ä¹‹é—´ï¼Œå“ªä¸€ä¸ªä¼šåœ¨è¿·å®«ä¸­æ‰¾åˆ°æ›´çŸ­çš„è·¯å¾„ï¼Ÿ
   1. DFS å°†å§‹ç»ˆæ‰¾åˆ°æ¯” BFS æ›´çŸ­çš„è·¯å¾„
   2. BFS å°†å§‹ç»ˆæ‰¾åˆ°æ¯” DFS æ›´çŸ­çš„è·¯å¾„
   3. DFS æœ‰æ—¶ï¼ˆä½†å¹¶éæ€»æ˜¯ï¼‰ä¼šæ‰¾åˆ°æ¯” BFS æ›´çŸ­çš„è·¯å¾„
   4. BFS æœ‰æ—¶ï¼ˆä½†å¹¶éæ€»æ˜¯ï¼‰ä¼šæ‰¾åˆ°æ¯” DFS æ›´çŸ­çš„è·¯å¾„
   5. ä¸¤ç§ç®—æ³•æ€»æ˜¯èƒ½æ‰¾åˆ°ç›¸åŒé•¿åº¦çš„è·¯å¾„
2. ä¸‹é¢çš„é—®é¢˜å°†é—®ä½ å…³äºä¸‹é¢è¿·å®«çš„é—®é¢˜ã€‚ç°è‰²å•å…ƒæ ¼è¡¨ç¤ºå¢™å£ã€‚åœ¨è¿™ä¸ªè¿·å®«ä¸Šè¿è¡Œäº†ä¸€ä¸ªæœç´¢ç®—æ³•ï¼Œæ‰¾åˆ°äº†ä» A ç‚¹åˆ° B ç‚¹çš„é»„è‰²çªå‡ºæ˜¾ç¤ºçš„è·¯å¾„ã€‚åœ¨è¿™æ ·åšçš„è¿‡ç¨‹ä¸­ï¼Œçº¢è‰²çªå‡ºæ˜¾ç¤ºçš„ç»†èƒæ˜¯æ¢ç´¢çš„çŠ¶æ€ï¼Œä½†å¹¶æ²¡æœ‰è¾¾åˆ°ç›®æ ‡ã€‚

    ![](https://cdn.xyxsw.site/MKtXbfJW3ocWT3xSMK0cwVc4nWf.png)

    åœ¨è®²åº§ä¸­è®¨è®ºçš„å››ç§æœç´¢ç®—æ³•ä¸­â€”â€”æ·±åº¦ä¼˜å…ˆæœç´¢ã€å¹¿åº¦ä¼˜å…ˆæœç´¢ã€æ›¼å“ˆé¡¿è·ç¦»å¯å‘å¼è´ªå©ªæœ€ä½³ä¼˜å…ˆæœç´¢å’Œæ›¼å“ˆé¡¿è·ç¦»å¯å‘å¼$A^*$

    æœç´¢â€”â€”å¯ä»¥ä½¿ç”¨å“ªä¸€ç§ï¼ˆæˆ–å¤šç§ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼‰ï¼Ÿ
   1. åªèƒ½æ˜¯$A^*$
   2. åªèƒ½æ˜¯è´ªå©ªæœ€ä½³ä¼˜å…ˆæœç´¢
   3. åªèƒ½æ˜¯ DFS
   4. åªèƒ½æ˜¯ BFS
   5. å¯èƒ½æ˜¯$A^*$æˆ–è´ªå©ªæœ€ä½³ä¼˜å…ˆæœç´¢
   6. å¯ä»¥æ˜¯ DFS æˆ– BFS
   7. å¯èƒ½æ˜¯å››ç§ç®—æ³•ä¸­çš„ä»»ä½•ä¸€ç§
   8. ä¸å¯èƒ½æ˜¯å››ç§ç®—æ³•ä¸­çš„ä»»ä½•ä¸€ç§
3. ä¸ºä»€ä¹ˆæœ‰æ·±åº¦é™åˆ¶çš„æå¤§æå°ç®—æ³•æœ‰æ—¶æ¯”æ²¡æœ‰æ·±åº¦é™åˆ¶çš„æå¤§æå°æ›´å¯å–ï¼Ÿ
   1. æ·±åº¦å—é™çš„æå¤§æå°ç®—æ³•å¯ä»¥æ›´å¿«åœ°åšå‡ºå†³å®šï¼Œå› ä¸ºå®ƒæ¢ç´¢çš„çŠ¶æ€æ›´å°‘
   2. æ·±åº¦å—é™çš„æå¤§æå°ç®—æ³•å°†åœ¨æ²¡æœ‰æ·±åº¦é™åˆ¶çš„æƒ…å†µä¸‹å®ç°ä¸æå¤§æå°ç®—æ³•ç›¸åŒçš„è¾“å‡ºï¼Œä½†æœ‰æ—¶ä¼šä½¿ç”¨è¾ƒå°‘çš„å†…å­˜
   3. æ·±åº¦å—é™çš„æå¤§æå°ç®—æ³•å¯ä»¥é€šè¿‡ä¸æ¢ç´¢å·²çŸ¥çš„æ¬¡ä¼˜çŠ¶æ€æ¥åšå‡ºæ›´ä¼˜åŒ–çš„å†³ç­–
   4. æ·±åº¦é™åˆ¶çš„æå°æå¤§å€¼æ°¸è¿œä¸ä¼šæ¯”æ²¡æœ‰æ·±åº¦é™åˆ¶çš„æå¤§æå°å€¼æ›´å¯å–
4. ä¸‹é¢çš„é—®é¢˜å°†è¯¢é—®æ‚¨å…³äºä¸‹é¢çš„ Minimax æ ‘ï¼Œå…¶ä¸­ç»¿è‰²å‘ä¸Šç®­å¤´è¡¨ç¤º MAX ç©å®¶ï¼Œçº¢è‰²å‘ä¸‹ç®­å¤´è¡¨ç¤º MIN ç©å®¶ã€‚æ¯ä¸ªå¶èŠ‚ç‚¹éƒ½æ ‡æœ‰å…¶å€¼ã€‚

![](https://cdn.xyxsw.site/UVssbyMxCoEQSuxvjh3caWAFnOb.png)

æ ¹èŠ‚ç‚¹çš„å€¼æ˜¯å¤šå°‘ï¼Ÿ
   1. 2
   2. 3
   3. 4
   4. 5
   5. 6
   6. 7
   7. 8
   8. 9
